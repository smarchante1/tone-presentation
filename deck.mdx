import {
  CodeSurfer,
  CodeSurferColumns,
  Step,
} from "code-surfer";
import { dracula, shadesOfPurple } from "@code-surfer/themes";

export const theme = shadesOfPurple;

# Music In The Browser üé∂

With [Tone.js](https://tonejs.github.io/) 

---

## What we'll learn


- How to create instruments with Tone.js

- Leverage libraries to create songs

- Utilize creative-coding to build interactive media

---

## About this workshop

- Watch or **code along** with companion modules

- Plug in some headphones and use a **safe volume level**

*Let's get started!*

---

<CodeSurfer>

```js title="Hello Tone" subtitle="Let's play our first note!"
import * as Tone from 'tone'

  const synth = new Tone.Synth().toDestination();

  synth.triggerAttackRelease("A4", "8n");
```

```diff 3 subtitle="Create a new synth instrument"

```

```diff 5 subtitle="Trigger an A that lasts an 8th note"

```

</CodeSurfer>

---

<CodeSurferColumns themes={[shadesOfPurple, dracula]}>

<Step>

```js title="FM Synthesizer" 
fmSynth.triggerAttackRelease("A4", "8n");
```

```js title="AM Synthesizer" 
amSynth.triggerAttackRelease("A4", "8n");
```

</Step>

<Step>

```js
import * as Tone from 'tone'
        
// FM Synth
const fmSynth = new Tone.FMSynth().toDestination();

//  .triggerAttackRelease makes a note sound
fmSynth.triggerAttackRelease("A4", "8n");
```

```js
import * as Tone from 'tone'
        
// AM Synth
const amSynth = new Tone.AMSynth().toDestination();

//  .triggerAttackRelease makes a note sound
amSynth.triggerAttackRelease("A4", "8n");
```

</Step>

</CodeSurferColumns>

---

<CodeSurfer>

```js title="Sampler Instrument" subtitle="Loading an mp3 file"
import * as Tone from 'tone'
        
const player = new Tone.Player("https://tonejs.github.io/audio/berklee/drum_low_1.mp3").toDestination();

function playSample() {
  Tone.loaded().then(() => {
  player.start();
  });
}
```

```diff 3 subtitle="Initialize a new player variable"

```

```diff 5 subtitle="Build a function to load audio"

```

```diff 7 subtitle="Start the audio after the mp3 has loaded"

```


</CodeSurfer>

---

# Let's map these notes to buttons, shall we?

---


## Enter **Reactronica**

- We can extend the functionality of Tone.js with 3P libraries

- Reactronica componentizes Songs, Tracks, and Instruments

*It's about to get funky in here! üé∂*

---

<CodeSurfer>

```js 5,35 title="Reactronica Song" subtitle="Song is the top level component"
  import { Song, Track, Instrument, Effect } from 'reactronica'
    
    const DemoSong = () => {
      return (
        <Song isPlaying={play} bpm={110}>
            <Track
                steps={['Eb4','G4','F4','Ab4']}
                volume={-12}
            >
                <Instrument type="duoSynth" />
                <Effect type="reverb" />
            </Track>

            <Track
                steps={[null, ['A1'], null, ['A1']]}
                volume={-10}
            >
                <Instrument 
                type="pluckSynth" 
                envelope={{
                    attack: 0.001,
                    decay: 0.15,
                    sustain: 0,
                    release:  0.03
                }}
                />
            </Track>

            <Track
                steps={[['D1', 'D1', 'D1', 'D1']]}
            >
                <Instrument type="membraneSynth" />
            </Track>

        </Song>
      )
    }
```

```diff 6,12 subtitle="Each song is made up of tracks"

```

```diff 7 subtitle="We can pass in an array of notes to play"

```

```diff 10 subtitle="We use the instrument component to pick our synth sound"

```

```diff 32 subtitle="And our drum kick"

```

```js title="Reactronica Song" subtitle="Let's give this song a listen!"
  import { Song, Track, Instrument, Effect } from 'reactronica'
    
    const DemoSong = () => {
      return (
        <Song isPlaying={play} bpm={110}>
            <Track
                steps={['Eb4','G4','F4','Ab4']}
                volume={-12}
            >
                <Instrument type="duoSynth" />
                <Effect type="reverb" />
            </Track>

            <Track
                steps={[null, ['A1'], null, ['A1']]}
                volume={-10}
            >
                <Instrument 
                type="pluckSynth" 
                envelope={{
                    attack: 0.001,
                    decay: 0.15,
                    sustain: 0,
                    release:  0.03
                }}
                />
            </Track>

            <Track
                steps={[['D1', 'D1', 'D1', 'D1']]}
            >
                <Instrument type="membraneSynth" />
            </Track>

        </Song>
      )
    }
```


</CodeSurfer>

---

# What have we learned?

- How to play synth notes with **Tone.js**
- How create multi-track songs with **Reactronica**
- How to leverage code to build fun and interactive creative media! üôåüèΩ

*Thank you!*

## ‚ùì‚ùì Q+A Time ‚ùì‚ùì